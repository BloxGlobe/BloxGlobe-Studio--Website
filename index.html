<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BloxGlobe Studio</title>

  <!-- Optional: load a web font for a modern look -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --accent: #00c8ff;
      --muted: #b0b0b0;
      --card-bg: rgba(255,255,255,0.04);
      --glass: rgba(255,255,255,0.03);
    }

    html,body { height: 100%; }
    body {
      margin: 0;
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #0b0c10 0%, #11151a 60%);
      color: #fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x: hidden;
    }

    /* Loading screen */
    #loading {
      position: fixed; inset: 0;
      display: flex; flex-direction: column; gap: 12px;
      justify-content: center; align-items: center;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.02), transparent 25%), #000;
      z-index: 4000;
      transition: opacity .5s ease, visibility .5s;
    }
    #loading.hidden { opacity: 0; visibility: hidden; pointer-events: none; }

    #loading img { width: 100px; height: auto; animation: float 2s ease-in-out infinite; }
    @keyframes float { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-6px) } }
    #loading h1 { margin: 0; color: var(--accent); font-size: 18px; }

    header {
      display: flex; gap: 12px; align-items: center; justify-content: space-between;
      padding: 12px 28px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      backdrop-filter: blur(8px);
      position: sticky; top: 0; z-index: 200;
      border-bottom: 1px solid rgba(255,255,255,0.03);
    }

    .logo { display:flex; align-items:center; gap:12px; }
    .logo img { width:44px; height:44px; border-radius:8px; object-fit:cover; }
    .logo h1 { margin:0; font-size:18px; font-weight:600; }

    .nav-links { display:flex; gap:14px; align-items:center; }
    .nav-links a, .nav-links button {
      color: #fff; text-decoration:none; background:none; border:none; cursor:pointer;
      padding:8px 10px; border-radius:8px; font-size:14px;
    }
    .nav-links a:hover, .nav-links button:hover { color:var(--accent); background:var(--glass); transform:translateY(-1px); }

    main { padding: 28px 48px; max-width:1200px; margin:0 auto; }

    #games {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 22px;
      margin-top: 18px;
    }

    .game-card {
      background: var(--card-bg);
      border-radius: 14px;
      padding: 14px;
      display:flex; flex-direction:column; gap:10px; align-items:center;
      transition: transform .18s ease, box-shadow .18s ease;
      box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    }
    .game-card:hover { transform: translateY(-6px); box-shadow: 0 14px 28px rgba(0,0,0,0.6); }

    .game-card .thumb {
      width:100%; height:160px; background:#0f1416; border-radius:10px; overflow:hidden;
      display:flex; align-items:center; justify-content:center;
    }
    .game-card .thumb img { width:100%; height:100%; object-fit:cover; display:block; }

    .game-card h3 { margin:4px 0 0 0; font-size:16px; }
    .game-card p { margin:0; color:var(--muted); font-size:13px; }

    .play-btn {
      margin-top:8px; background:var(--accent); color:#fff; border:none;
      padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600;
    }
    .play-btn:hover { background:#009edb; }

    .update-log {
      background: var(--card-bg);
      border-radius:12px; padding:16px; margin-top: 26px;
    }
    .update-log header { display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .update-log .controls { display:flex; gap:8px; }
    .small-btn { background:var(--accent); color:#fff; border:none; padding:6px 10px; border-radius:8px; cursor:pointer; }
    .small-btn.ghost { background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); }

    #logContent { margin-top:12px; min-height:70px; color:var(--muted); }
    #logContent[contenteditable="true"] { outline: 2px dashed rgba(0,200,255,0.12); color:#fff; }

    .overlay {
      display: none; position: fixed; inset: 0; z-index: 3000;
      background: rgba(0,0,0,0.6); backdrop-filter: blur(6px);
      align-items:center; justify-content:center; gap:12px; color:#fff; flex-direction:column;
    }
    .overlay.visible { display:flex; }

    .spinner {
      border: 5px solid rgba(255,255,255,0.12);
      border-top: 5px solid var(--accent);
      border-radius: 50%;
      width: 48px; height: 48px; animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .feedback-modal {
      display:none; position:fixed; z-index:3200; left:50%; top:50%; transform:translate(-50%,-50%);
      width:360px; background: #0b0d0f; padding:16px; border-radius:10px; box-shadow: 0 10px 30px rgba(0,0,0,0.6);
    }
    .feedback-modal.visible { display:block; }
    .feedback-modal textarea { width:100%; min-height:90px; resize:vertical; padding:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:#070809; color:#fff; }

    footer { text-align:center; padding:28px; margin-top:26px; color:var(--muted); font-size:13px; }
    footer a { color:var(--accent); text-decoration:none; }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading" role="status" aria-live="polite">
    <img src="https://static.vecteezy.com/system/resources/thumbnails/018/867/786/small/halloween-pumpkin-face-free-png.png" alt="decorative pumpkin">
    <h1>üéÉ Happy Halloween from BloxGlobe Studio‚Ñ¢</h1>
    <div style="color:var(--muted);font-size:13px">Loading content‚Ä¶</div>
  </div>

  <header>
    <div class="logo" role="banner">
      <img src="YOUR_ROBLOX_LOGO.png" alt="Studio logo">
      <h1>BloxGlobe Studio</h1>
    </div>

    <nav class="nav-links" aria-label="Main navigation">
      <a href="https://www.roblox.com/users/5525937576/profile" target="_blank" rel="noopener">Roblox Profile</a>
      <a href="https://whatsapp.com/channel/0029VaAfKWq7BLtUakspqi1R" target="_blank" rel="noopener">Follow Channel</a>
      <button id="feedbackBtn" aria-haspopup="dialog">üí¨ Feedback</button>
    </nav>
  </header>

  <main>
    <section id="games" aria-labelledby="gamesTitle">
      <h2 id="gamesTitle" style="grid-column:1/-1; margin:0 0 8px 0; font-size:18px;">Featured Games</h2>

      <article class="game-card" data-id="135869717619701" aria-labelledby="gn1">
        <div class="thumb" aria-hidden="true"><img src="" alt=""></div>
        <h3 id="gn1">ReadyNode [Beta]</h3>
        <p>Explore the early build of ReadyNode!</p>
        <button class="play-btn" onclick="window.open('https://www.roblox.com/games/135869717619701/Beta','_blank')">Play</button>
      </article>

      <article class="game-card" data-id="85250100428738" aria-labelledby="gn2">
        <div class="thumb" aria-hidden="true"><img src="" alt=""></div>
        <h3 id="gn2">R25</h3>
        <p>R25 is your new way to play and build!</p>
        <button class="play-btn" onclick="window.open('https://www.roblox.com/games/85250100428738/R25','_blank')">Play</button>
      </article>
    </section>

    <section class="update-log" aria-labelledby="logTitle">
      <header>
        <h2 id="logTitle" style="margin:0;font-size:16px;">Update Log</h2>
        <div class="controls">
          <button class="small-btn ghost" id="saveLogBtn" title="Save update log">Save</button>
          <button class="small-btn" id="editLogBtn" title="Edit update log">Edit</button>
        </div>
      </header>

      <div id="logContent" contenteditable="false" aria-live="polite">
        <p>üî• Update 1.5.4 - Fixed UI stretching & layout issues.</p>
        <p>üí¨ Added Feedback system for reports & feature requests.</p>
        <p>üß† Improved performance and design polish.</p>
      </div>
    </section>
  </main>

  <div class="overlay" id="updateOverlay" role="status" aria-hidden="true">
    <div class="spinner" aria-hidden="true"></div>
    <p id="updateOverlayText">Updating website...</p>
  </div>

  <div class="feedback-modal" id="feedbackModal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="feedbackTitle">
    <h3 id="feedbackTitle" style="margin-top:0">Send Feedback</h3>
    <textarea id="feedbackText" placeholder="Describe the issue..." aria-label="Feedback text"></textarea>
    <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:8px;">
      <button class="small-btn" id="sendFeedbackBtn">Send Report</button>
      <button class="small-btn ghosok</div>t" id="closeF eedbackBtn">Close</button>
    </div>
  </div>

  <footer>
    Founder & Developer: <a href="#">Abel</a><br />
    ¬© 2025 BloxGlobe Studio‚Ñ¢. All rights reserved.
  </footer>

  <script>
    // Utility: safe text encode for URL
    co</section>nst encode = (s) => encodeURIComponent(String(s || ''));

    // Hide loading after window load or timeout
    const loadingEl = document.getElementById('loading');
    function hideLoading() {
      loadingEl.classList.add('hidden');
      setTimeout(() => loadingEl.remove(), 700);
    }
    window.addEventListener('load', hideLoading);
    // fallback in case load event takes long
    setTimeout(() => { if (document.body.contains(loadingEl)) hideLoading(); }, 5000);

    // Update overlay handling (version check)
    (async function checkVersion() {
      try {
        const r = await fetch('version.json?' + Date.now(), { cache: 'no-store' });
        if (!r.ok) return;
        const d = await r.json();
        const vLocal = localStorage.getItem('bloxglobeVersion') || '1.5.2';
        if (d.version && d.version !== vLocal) {
          const overlay = document.getElementById('updateOverlay');
          overlay.classList.add('visible');
          overlay.setAttribute('aria-hidden','false');
          setTimeout(() => {
            overlay.classList.remove('visible');
            overlay.setAttribute('aria-hidden','true');
            localStorage.setItem('bloxglobeVersion', d.version);
          }, 20000);
        }
      } catch (err) {
        console.debug('Version check failed:', err);
      }
    })();

    // Feedback modal
    const feedbackModal = document.getElementById('feedbackModal');
    const feedbackBtn = document.getElementById('feedbackBtn');
    const closeFeedbackBtn = document.getElementById('closeFeedbackBtn');
    const sendFeedbackBtn = document.getElementById('sendFeedbackBtn');

    function openFeedback() {
      feedbackModal.classList.add('visible');
      feedbackModal.setAttribute('aria-hidden','false');
      document.getElementById('feedbackText').focus();
    }
    function closeFeedback() {
      feedbackModal.classList.remove('visible');
      feedbackModal.setAttribute('aria-hidden','true');
    }

    feedbackBtn.addEventListener('click', openFeedback);
    closeFeedbackBtn.addEventListener('click', closeFeedback);

    sendFeedbackBtn.addEventListener('click', () => {
      const text = document.getElementById('feedbackText').value;
      if (!text.trim()) return alert('Please describe your issue!');
      const githubURL = `https://github.com/BloxGlobe/BloxGlobe-Studio--Website/issues/new?title=${encode('Feedback')}&body=${encode(text)}`;
      window.open(githubURL, '_blank', 'noopener');
      closeFeedback();
    });

    // Update Log editing + save to localStorage
    const editBtn = document.getElementById('editLogBtn');
    const saveBtn = document.getElementById('saveLogBtn');
    const logContent = document.getElementById('logContent');

    editBtn.addEventListener('click', () => {
      const isEditing = logContent.getAttribute('contenteditable') === 'true';
      logContent.setAttribute('contenteditable', isEditing ? 'false' : 'true');
      if (!isEditing) {
        logContent.focus();
        editBtn.textContent = 'Stop';
      } else {
        editBtn.textContent = 'Edit';
      }
    });

    saveBtn.addEventListener('click', () => {
      logContent.setAttribute('contenteditable','false');
      editBtn.textContent = 'Edit';
      localStorage.setItem('bloxglobeLog', logContent.innerHTML);
      alert('Update log saved locally.');
    });

    // Load saved log if exists
    const savedLog = localStorage.getItem('bloxglobeLog');
    if (savedLog) logContent.innerHTML = savedLog;

    // Roblox API integration with fallbacks and safe guards
    async function loadGameInfo(universeId, card) {
      const thumbEl = card.querySelector('.thumb img');
      const statsEl = document.createElement('div');
      statsEl.style.width = '100%';
      statsEl.style.textAlign = 'left';
      statsEl.style.fontSize = '13px';
      statsEl.style.color = 'var(--muted)';

      // default placeholders
      thumbEl.src = '';
      thumbEl.alt = 'Game thumbnail';
      statsEl.innerHTML = '<p style="margin:0;color:var(--muted)">Loading info‚Ä¶</p>';
      card.appendChild(statsEl);

      try {
        const gameInfoUrl = `https://games.roblox.com/v1/games?universeIds=${encodeURIComponent(universeId)}`;
        const thumbUrl = `https://thumbnails.roblox.com/v1/games/icons?universeIds=${encodeURIComponent(universeId)}&size=512x512&format=Png`;
        const votesUrl = `https://games.roblox.com/v1/games/votes?universeIds=${encodeURIComponent(universeId)}`;

        const [giRes, thRes, voRes] = await Promise.allSettled([
          fetch(gameInfoUrl),
          fetch(thumbUrl),
          fetch(votesUrl)
        ]);

        let game = null, thumb = null, votes = null;

        if (giRes.status === 'fulfilled' && giRes.value.ok) {
          const j = await giRes.value.json();
          game = j.data && j.data[0] ? j.data[0] : null;
        }

        if (thRes.status === 'fulfilled' && thRes.value.ok) {
          const j = await thRes.value.json();
          thumb = j.data && j.data[0] ? j.data[0].imageUrl : null;
        }

        if (voRes.status === 'fulfilled' && voRes.value.ok) {
          const j = await voRes.value.json();
          votes = j.data && j.data[0] ? j.data[0] : null;
        }

        // Fallbacks
        if (!thumb) {
          thumb = 'data:image/svg+xml;utf8,' +
            encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="512" height="512"><rect width="100%" height="100%" fill="#0b0d0f"/><text x="50%" y="50%" fill="#888" font-size="28" font-family="Poppins,sans-serif" text-anchor="middle" dy=".3em">No Image</text></svg>');
        }
        thumbEl.src = thumb;
        thumbEl.alt = game && game.name ? game.name : 'Game thumbnail';
        // Build stats safely
        const visits = game && typeof game.visits === 'number' ? game.visits.toLocaleString() : 'N/A';
        const playing = game && typeof game.playing === 'number' ? game.playing.toLocaleString() : 'N/A';
        const up = votes && typeof votes.upVotes === 'number' ? votes.upVotes.toLocaleString() : 'N/A';
        const down = votes && typeof votes.downVotes === 'number' ? votes.downVotes.toLocaleString() : 'N/A';

        statsEl.innerHTML = `
          <p style="margin:6px 0 4px 0;"><strong>${game && game.name ? escapeHtml(game.name) : 'Untitled'}</strong></p>
          <p style="margin:0">üëÄ ${visits} visits ¬∑ üßç ${playing} playing</p>
          <p style="margin:6px 0 0 0">üëç ${up} ¬∑ üëé ${down}</p>
        `;
      } catch (err) {
        console.error('Roblox API error:', err);
        statsEl.innerHTML = '<p style="margin:0;color:var(--muted)">Failed to load game info.</p>';
      }
    }

    // basic escape for inserted plain text
    function escapeHtml(s) {
      return (s+'').replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]; });
    }

    // initialize cards
    document.querySelectorAll('.game-card').forEach(card => {
      const id = card.dataset.id;
      if (!id) return;
      loadGameInfo(id, card);
    });

    // Accessibility: close feedback on Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (feedbackModal.classList.contains('visible')) closeFeedback();
      }
    });
  </script>
</body>
</html>
